<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Servicio</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link href="style.css" rel="stylesheet" />
  </head>

  <body>
    <!-- NAVBAR -->
    <nav
      class="navbar navbar-expand-lg navbar-dark bg-dark"
      id="menu"
      style="min-height: 56px"
    ></nav>
    <div
      id="bannerEstado"
      class="alert text-center m-0 py-2 d-none banner"
      role="alert"
    ></div>

    <!-- CONTENIDO DE LA SECCIÃ“N -->
    <div class="marginBody">
      <!-- BotÃ³n Crear -->
      <div class="d-flex justify-content-between mb-3">
        <h3>ğŸ’¼ Servicio del campo</h3>
        <div class="d-flex gap-1">
          <button
            class="btn btn-primary d-flex align-items-center"
            title="Descargar tarjetas"
            data-bs-toggle="modal"
            data-bs-target="#modalDescargarTarjetas"
          >
            <span class="me-2 d-none d-sm-inline">ğŸ“„ Descargar tarjetas</span>
            <span class="d-inline d-sm-none">ğŸ“„</span>
          </button>
          <button
            class="btn btn-primary d-flex align-items-center"
            onclick="actualizar()"
            title="Actualizar informaciÃ³n"
          >
            <span class="me-2 d-none d-sm-inline">ğŸ”„ Actualizar</span>
            <span class="d-inline d-sm-none">ğŸ”„</span>
          </button>
        </div>
      </div>
      <!-- Leyenda de colores -->
      <div
        class="alert alert-light border d-flex flex-wrap gap-3 mb-3 p-2 small"
      >
        <div><span class="badge">ğŸ”´ Precursor regular</span></div>
        <div><span class="badge">âš« Inactivo</span></div>
      </div>

      <!-- FILTRO AÃ‘O MES -->
      <div class="row g-2 mb-2">
        <div class="col-md-6">
          <label for="anio" class="form-label"
            >AÃ±o <span class="text-danger">*</span></label
          >
          <select class="form-select" id="anio" required></select>
        </div>
        <div class="col-md-6">
          <label for="mes" class="form-label"
            >Mes<span class="text-danger">*</span></label
          >
          <select class="form-select" id="mes" required></select>
        </div>
      </div>

      <div class="input-group mb-3">
        <input
          type="text"
          id="buscadorPublicador"
          class="form-control"
          placeholder="Buscar publicador por nombre..."
          onkeydown="if (event.key === 'Enter') { event.preventDefault(); buscarPublicador(); }"
        />

        <button
          class="btn btn-primary"
          onclick="buscarPublicador()"
          title="Buscar publicador"
        >
          <span class="me-2 d-none d-sm-inline">ğŸ” Buscar</span>
          <span class="d-inline d-sm-none">ğŸ”</span>
        </button>

        <button
          class="btn btn-outline-secondary"
          onclick="limpiarBusquedaPublicador()"
          title="Limpiar bÃºsqueda"
        >
          ğŸ§¹
        </button>
      </div>

      <div id="tablasGrupos" class="grid-2"></div>

      <!-- Modal descargar tarjetas -->
      <div
        class="modal fade"
        id="modalDescargarTarjetas"
        tabindex="-1"
        aria-labelledby="modalDescargarTarjetasLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-sm">
          <div class="modal-content">
            <section id="formPublicador" data-edicion-id="">
              <div class="modal-header main">
                <h5 class="modal-title" id="modalDescargarTarjetasLabel">
                  ğŸ“„ Seleccione los datos
                </h5>
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="modal"
                  aria-label="Cerrar"
                ></button>
              </div>
              <div class="modal-body">
                <div>
                  <label for="anio-descarga" class="form-label"
                    >AÃ±o <span class="text-danger">*</span>
                  </label>
                  <select
                    class="form-select"
                    id="anio-descarga"
                    required
                  ></select>
                </div>
                <div class="mb-3">
                  <label for="grupo-descarga" class="form-label"
                    >Grupo <span class="text-danger">*</span>
                  </label>
                  <select
                    class="form-select"
                    id="grupo-descarga"
                    required
                  ></select>
                </div>

                <div class="modal-footer p-0 pt-2">
                  <button
                    type="button"
                    onclick="descargarTarjetas()"
                    class="btn btn-success"
                  >
                    â¬‡ Descargar
                  </button>
                  <button
                    type="button"
                    class="btn btn-secondary"
                    data-bs-dismiss="modal"
                  >
                    âŒ Cancelar
                  </button>
                </div>
              </div>
            </section>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/docx@9.0.3/build/index.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="main.js"></script>
    <script src="scripts/date-functions.js"></script>
    <script src="scripts/utils-functions.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", async function () {
        await cargarMenuYScripts();
        cargarAniosSelect("anio");
        cargarAniosSelect("anio-descarga");
        cargarMesesSelect("mes");
        verificarSesionActiva();
        iniciarPublicadores();
      });
    </script>
  </body>
</html>
